{"Q": "Expectation of $\\frac{X_1^4}{(X_1^2 + \\cdots + X_d^2)^2}$ \nLet $X_1$, $X_2$, $\\cdots$, $X_d \\sim \\mathcal{N}(0, 1)$ and be independent. What is the expectation of $\\frac{X_1^4}{(X_1^2 + \\cdots + X_d^2)^2}$?\n\nIt is easy to find $\\mathbb{E}\\left(\\frac{X_1^2}{X_1^2 + \\cdots + X_d^2}\\right) = \\frac{1}{d}$ by symmetry. But I do not know how to find the expectation of $\\frac{X_1^4}{(X_1^2 + \\cdots + X_d^2)^2}$. Could you please provide some hints?\nWhat I have obtained so far\nI wanted to find $\\mathbb{E}\\left(\\frac{X_1^4}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$ by symmetry. But this case is different from that for $\\mathbb{E}\\left(\\frac{X_1^2}{X_1^2 + \\cdots + X_d^2}\\right)$ because $\\mathbb{E}\\left(\\frac{X_i^4}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$ may be not equal to $\\mathbb{E}\\left(\\frac{X_i^2X_j^2}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$. So I need some other ideas to find the expectation.\nWhere this question comes from\nA question in mathematics stack exchange asks for the variance of $\\|Ax\\|_2^2$ for a unit uniform random vector $x$ on $S^{d-1}$. My derivation shows that the answer depends sorely on the values of $\\mathbb{E}\\left(\\frac{X_i^4}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$ and $\\mathbb{E}\\left(\\frac{X_i^2X_j^2}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$ for $i \\neq j$. Since\n$$\n\\sum_{i \\neq j}\\mathbb{E} \\left( \\frac{X_i^2X_j^2}{(X_1^2 + \\cdots + X_d^2)^2}\\right) + \\sum_i \\mathbb{E}\\left(\\frac{X_i^4}{(X_1^2 + \\cdots + X_d^2)^2}\\right) = 1\n$$\nand by symmetry, we only need to know the value of $\\mathbb{E}\\left(\\frac{X_1^4}{(X_1^2 + \\cdots + X_d^2)^2}\\right)$ to obtain other expectations.\n", "A": "The distribution of $X_i^2$ is chi-square (and also a special case of gamma).\nThe distribution of $\\frac{X_1^2}{X_1^2 + \\cdots + X_d^2}$ is thereby beta.\nThe expectation of the square of a beta isn't difficult.\n", "meta": {"language": "en", "url": "https://stats.stackexchange.com/questions/222915", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "10", "answer_count": 2, "answer_id": 0}}
{"Q": "$(2Y-1)\\sqrt X\\sim\\mathcal N(0,1)$ when $X\\sim\\chi^2_{n-1}$ and $Y\\sim\\text{Beta}\\left(\\frac{n}{2}-1,\\frac{n}{2}-1\\right)$ independently \n$X$ and $Y$ are independently distributed random variables where $X\\sim\\chi^2_{(n-1)}$ and $Y\\sim\\text{Beta}\\left(\\frac{n}{2}-1,\\frac{n}{2}-1\\right)$. What is the distribution of $Z=(2Y-1)\\sqrt X$ ?\n\nJoint density of $(X,Y)$ is given by\n$$f_{X,Y}(x,y)=f_X(x)f_Y(y)=\\frac{e^{-\\frac{x}{2}}x^{\\frac{n-1}{2}-1}}{2^{\\frac{n-1}{2}}\\Gamma\\left(\\frac{n-1}{2}\\right)}\\cdot\\frac{y^{\\frac{n}{2}-2}(1-y)^{\\frac{n}{2}-2}}{B\\left(\\frac{n}{2}-1,\\frac{n}{2}-1\\right)}\\mathbf1_{\\{x>0\\,,\\,0<y<1\\}}$$\nUsing the change of variables $(X,Y)\\mapsto(Z,W)$ such that $Z=(2Y-1)\\sqrt X$ and $W=\\sqrt X$, \nI get the joint density of $(Z,W)$ as\n$$f_{Z,W}(z,w)=\\frac{e^{-\\frac{w^2}{2}}w^{n-3}\\left(\\frac{1}{4}-\\frac{z^2}{4w^2}\\right)^{\\frac{n}{2}-2}}{2^{\\frac{n-1}{2}}\\Gamma\\left(\\frac{n-1}{2}\\right)B\\left(\\frac{n}{2}-1,\\frac{n}{2}-1\\right)}\\mathbf1_{\\{w>0\\,,\\,|z|<w\\}}$$\nMarginal pdf of $Z$ is then \n$f_Z(z)=\\displaystyle\\int_{|z|}^\\infty f_{Z,W}(z,w)\\,\\mathrm{d}w$, which does not lead me anywhere.\nAgain, while finding the distribution function of $Z$, an incomplete beta/gamma function shows up:\n$F_Z(z)=\\Pr(Z\\le z)$\n$\\quad\\qquad=\\Pr((2Y-1)\\sqrt X\\le z)=\\displaystyle\\iint_{(2y-1)\\sqrt{x}\\le z}f_{X,Y}(x,y)\\,\\mathrm{d}x\\,\\mathrm{d}y$\nWhat is an appropriate change of variables here? Is there another way to find the distribution of $Z$?\nI tried using different relations between Chi-Squared, Beta, 'F' and 't' distributions but nothing seems to work. Perhaps I am missing something obvious.\n\nAs mentioned by @Francis, this transformation is a generalization of the Box-M\u00fcller transform.\n", "A": "As user @Chaconne has already done, I was able to provide an algebraic proof with this particular transformation. I have not skipped any details.\n\n(We already have $n>2$ for the density of $Y$ to be valid).\nLet us consider the transformation $(X,Y)\\mapsto (U,V)$ such that $U=(2Y-1)\\sqrt{X}$ and $V=X$.\nThis implies $x=v$ and $y=\\frac{1}{2}\\left(\\frac{u}{\\sqrt{v}}+1\\right)$. \nNow, $x>0\\implies v>0$ and $0<y<1\\implies-\\sqrt{v}<u<\\sqrt{v}$, \nso that the  bivariate support of $(U,V)$ is simply $S=\\{(u,v):0<u^2<v<\\infty,\\,u\\in\\mathbb{R}\\}$.\nAbsolute value of the Jacobian of transformation is $|J|=\\frac{1}{2\\sqrt{v}}$.\nJoint density of $(U,V)$ is thus\n$$f_{U,V}(u,v)=\\frac{e^{-\\frac{v}{2}}v^{\\frac{n-1}{2}-1}\\left(\\frac{u}{\\sqrt{v}}+1\\right)^{\\frac{n}{2}-2}\\left(\\frac{1}{2}-\\frac{u}{2\\sqrt{v}}\\right)^{\\frac{n}{2}-2}\\Gamma(n-2)}{(2\\sqrt{v})\\,2^{\\frac{n-1}{2}+\\frac{n}{2}-2}\\,\\Gamma\\left(\\frac{n-1}{2}\\right)\\left(\\Gamma\\left(\\frac{n}{2}-1\\right)\\right)^2}\\mathbf1_{S}$$\n$$=\\frac{e^{-\\frac{v}{2}}v^{\\frac{n-4}{2}}(\\sqrt{v}+u)^{\\frac{n}{2}-2}(\\sqrt{v}-u)^{\\frac{n}{2}-2}\\,\\Gamma(n-2)}{2^{\\frac{2n-3}{2}+\\frac{n}{2}-2}\\,(\\sqrt{v})^{n-4}\\,\\Gamma\\left(\\frac{n-1}{2}\\right)\\left(\\Gamma\\left(\\frac{n-2}{2}\\right)\\right)^2}\\mathbf1_{S}$$\nNow, using Legendre's duplication formula,\n$\\Gamma(n-2)=\\frac{2^{n-3}}{\\sqrt \\pi}\\Gamma\\left(\\frac{n-2}{2}\\right)\\Gamma\\left(\\frac{n-2}{2}+\\frac{1}{2}\\right)=\\frac{2^{n-3}}{\\sqrt \\pi}\\Gamma\\left(\\frac{n-2}{2}\\right)\\Gamma\\left(\\frac{n-1}{2}\\right)$ where $n>2$.\nSo for $n>2$, $$f_{U,V}(u,v)=\\frac{2^{n-3}\\,e^{-\\frac{v}{2}}(v-u^2)^{\\frac{n}{2}-2}}{\\sqrt \\pi\\,2^{\\frac{3n-7}{2}}\\,\\Gamma\\left(\\frac{n}{2}-1\\right)}\\mathbf1_{S}$$\nMarginal pdf of $U$ is then given by\n$$f_U(u)=\\frac{1}{2^{\\frac{n-1}{2}}\\sqrt \\pi\\,\\Gamma\\left(\\frac{n}{2}-1\\right)}\\int_{u^2}^\\infty e^{-\\frac{v}{2}}(v-u^2)^{\\frac{n}{2}-2}\\,\\mathrm{d}v$$\n$$=\\frac{e^{-\\frac{u^2}{2}}}{2^{\\frac{n-1}{2}}\\sqrt \\pi\\,\\Gamma\\left(\\frac{n}{2}-1\\right)}\\int_0^\\infty e^{-\\frac{t}{2}}\\,t^{(\\frac{n}{2}-1-1)}\\,\\mathrm{d}t$$\n$$=\\frac{1}{2^{\\frac{n-1}{2}}\\sqrt \\pi\\,\\left(\\frac{1}{2}\\right)^{\\frac{n}{2}-1}}e^{-\\frac{u^2}{2}}$$\n$$=\\frac{1}{\\sqrt{2\\pi}}e^{-u^2/2}\\,,u\\in\\mathbb{R}$$\n", "meta": {"language": "en", "url": "https://stats.stackexchange.com/questions/327499", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "13", "answer_count": 5, "answer_id": 1}}
{"Q": "Testing whether $X\\sim\\mathsf N(0,1)$ against the alternative that $f(x) =\\frac{2}{\\Gamma(1/4)}\\text{exp}(\u2212x^4)\\text{ }I_{(-\\infty,\\infty)}(x)$ \nConsider the most powerful test of the null hypothesis that $X$ is a\n  standard normal random variable against the alternative that $X$ is a\n  random variable having pdf \n$$f(x) =\\frac{2}{\\Gamma(1/4)}\\text{exp}(\u2212x^4)\\text{\n }I_{(-\\infty,\\infty)}(x)$$\nand give the p-value if the observed value of $X$ is $0.6$\n\nMy try:\nI think I should be using a likelihood ratio test.\nI read that the Neyman\u2013Pearson lemma states that the likelihood ratio test is the most powerful among all level $\\alpha$  tests.\nWe have that the likelihood ratio is\n$$\\frac{f_0(x)}{f_1(x)}=\\frac{\\frac{1}{\\sqrt{2\\pi}}\\text{exp}(-x^2/2)}{\\frac{2}{\\Gamma(1/4)}\\text{exp}(-x^4)}=\\frac{\\Gamma(1/4)}{\\sqrt{8\\pi}}\\text{exp}\\left(\\frac{-x^2}{2}+x^4\\right)$$\nThus we accept $H_0$ if\n$$\\frac{\\Gamma(1/4)}{\\sqrt{8\\pi}}\\text{exp}\\left(\\frac{-x^2}{2}+x^4\\right)\\geq c$$\nor equivalently if\n$$\\frac{-x^2}{2}+x^4 \\geq \\text{log}\\left(\\frac{\\sqrt{8\\pi}\\cdot c}{\\Gamma(1/4)}\\right)$$\nor equivalently if one of the following holds:\n$$x^2\\geq \\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}$$\n$$x^2\\geq \\frac{1-\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}$$\nor equivalently if one of the following holds:\n$$x\\geq \\sqrt{\\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}$$\n$$x\\leq -\\sqrt{\\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}$$\n$$x\\geq \\sqrt{\\frac{1-\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}$$\n$$x\\leq -\\sqrt{\\frac{1-\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}$$\nFor a meaningful acceptance region we only consider the top two of the four constraints. Hence we reject if $$x\\in\\left(-\\sqrt{\\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}},\\sqrt{\\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}\\right)$$\nWe wish, under the null, that the probability that $X$ assumes a value in this range to be $0.05$\nFor this to occur, we need\n$$\\sqrt{\\frac{1+\\sqrt{1+16\\cdot\\text{log}(1.382746\\cdot c)}}{4}}=0.06270678$$\nBut software gives that there are no solutions for $c\\in\\mathbb{R}$. Any suggestions or confirmation of my approach would be much appreciated.\n", "A": "The test will reject $H_0$ for sufficiently large values of the ratio\n$$\\begin{align*}\n\\frac{2}{\\Gamma\\left(\\frac{1}{4}\\right)}\\frac{\\text{exp}\\left(-x^4\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\text{exp}\\left(-\\frac{x^2}{2}\\right)}\n&=\\frac{2\\sqrt{2\\pi}}{\\Gamma\\left(\\frac{1}{4}\\right)}\\text{exp}\\left(-x^4+\\frac{1}{2}x^2\\right)\\\\\\\\\n&=\\frac{2\\sqrt{2\\pi}}{\\Gamma\\left(\\frac{1}{4}\\right)}e^{\\frac{1}{16}}\\text{exp}\\left(-x^4+\\frac{1}{2}x^2-\\frac{1}{16}\\right)\\\\\\\\\n&=c\\cdot\\text{exp}\\left(-\\left[x^2-\\frac{1}{4}\\right]^2\\right)\n\\end{align*}$$\nwhere $c$ is a positive constant. For the observed value of $x$, this ratio equals\n$$c\\cdot\\text{exp}\\left(-\\left[0.6^2-\\frac{1}{4}\\right]^2\\right)=c\\cdot\\text{exp}(-0.0121)$$\nThe desired p-value is the probability, when $H_0$ is true, that $X$ assumes any value $x$ such that $$c\\cdot\\text{exp}\\left(-\\left[x^2-\\frac{1}{4}\\right]^2\\right)\\geq c\\cdot\\text{exp}(-0.0121)$$\nSuch values of $x$ satisfy\n$$\\left[x^2-\\frac{1}{4}\\right]^2\\leq 0.0121\\Rightarrow\\left|x^2-\\frac{1}{4}\\right|\\leq0.11$$\nHence $$-0.11\\leq x^2-\\frac{1}{4}\\leq0.11\\Rightarrow 0.14\\leq x^2 \\leq 0.36$$\nThen $$\\sqrt{0.14}\\leq x \\leq 0.6 \\text{ or } -0.6\\leq x \\leq -\\sqrt{0.14}$$\nBecause the standard normal pdf is symmetric about $0$, the desired p-value is \n$$2\\left[\\Phi(0.6)-\\Phi(\\sqrt{0.14})\\right]=0.16$$\n", "meta": {"language": "en", "url": "https://stats.stackexchange.com/questions/379808", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "5", "answer_count": 2, "answer_id": 1}}
{"Q": "Probability of Weibull RV conditional on another Weibull RV Let $X, Y$ be independent Weibull distributed random variables and $x>0$ a constant. Is there a closed form solution to calculating the probability $$P(X<x|X<Y)?$$\nOr maybe a way to approximate this probability?\n", "A": "Letting $a_1,b_1$ and $a_2,b_2$ denote the parameters of $X$ and $Y$, and assuming that $b_1=b_2=b$,\n\\begin{align}\nP(X<x \\cap X<Y)\n  &=\\int_0^x \\int_x^\\infty f_X(x)f_Y(y) dy\\,dx\n\\\\&=\\int_0^x f_X(x)(1-F_Y(x))dx\n\\\\&=\\int_0^x a_1 b x^{b-1}e^{-a_1 x^b - a_2 x^b} dx\n\\\\&=\\frac{a_1}{a_1+a_2}\\int_0^{(a_1+a_2)x^b}e^{-u}du\n\\\\&=\\frac{a_1}{a_1+a_2}(1-e^{-(a_1+a_2)x^b}).\n\\end{align}\nSimilarly,\n$$\nP(X<Y)=\\int_0^\\infty \\int_x^\\infty f_X(x)f_Y(y) dy\\,dx=\\frac{a_1}{a_1+a_2}\n$$\nand so\n$$\nP(X<x|X<Y)=1-e^{-(a_1+a_2)x^b}.\n$$\nIf instead $b_1=b$ and $b_2=2b$,\n\\begin{align}\nP(X<x \\cap X<Y)\n  &=\\int_0^x a_1 b x^{b-1}e^{-a_1 x^b - a_2 x^{2b}} dx\n\\\\&=\\frac{a_1}{\\sqrt{a_2}}\\int_0^{\\sqrt{a_2}x^b}e^{-(u^2+\\frac{a_1}{\\sqrt{a_2}}u)}du\n\\\\&=\\frac{a_1}{\\sqrt{a_2}}e^{\\frac{a_1^2}{4a_2}}\\int_0^{\\sqrt{a_2}x^b}e^{-(u+\\frac{a_1}{2\\sqrt{a_2}})^2}du\n\\\\&=\\frac{a_1}{\\sqrt{a_2}}e^{\\frac{a_1^2}{4a_2}}\\int_{\\frac{a_1^2}{4a_2}}^{(\\sqrt{a_2}x^b+\\frac{a_1}{2\\sqrt{a_2}})^2}v^{-\\frac12}e^{-v}dv\n\\\\&=\\frac{a_1}{\\sqrt{a_2}}e^{\\frac{a_1^2}{4a_2}}\\left(\\Gamma\\left(\\frac12,\\frac{a_1^2}{4a_2}\\right)-\\Gamma\\left(\\frac12,\\left(\\sqrt{a_2}x^b+\\frac{a_1}{2\\sqrt{a_2}}\\right)^2\\right)\\right),\n\\end{align}\nwhere $\\Gamma$ is the (upper) incomplete Gamma function.  A similar calculation for $P(X<Y)$ leads to\n$$\nP(X<x|X<Y)=1-\\frac{\\Gamma\\left(\\frac12,\\left(\\sqrt{a_2}x^b+\\frac{a_1}{2\\sqrt{a_2}}\\right)^2\\right)}{\\Gamma\\left(\\frac12,\\frac{a_1^2}{4a_2}\\right)}.\n$$\n", "meta": {"language": "en", "url": "https://stats.stackexchange.com/questions/513466", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4", "answer_count": 1, "answer_id": 0}}
